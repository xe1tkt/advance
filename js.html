<script>

    function crearTablaContactos()
    {
        let tabla=document.getElementById('tablaContactos');
                if(tabla) tabla.remove();
        google.script.run
        .withSuccessHandler(crearTablaContactosOK)
        .withFailureHandler(crearTablaContactosError)
        .obtenerContactos();


    }
    
            
    function crearTablaContactosOK(obj)
            { 
            tabla=document.createElement('table');
            tabla.id='tablaContactos';
            let tablaHeader=document.createElement('thead');
            let tablaBody = document.createElement('tbody');

            Array.from(obj).forEach((filaActual,i)=>
            {
                let fila=document.createElement('tr');
                filaActual.forEach(celdaActual=>
                {
                    let celda=document.createElement('td');
                    celda.textContent=celdaActual;
                    fila.appendChild(celda);
                });
                if(i==0)
                {
                    tablaHeader.appendChild(fila);
                    tabla.appendChild(tablaHeader);
                }
                else
                {
                    tablaBody.appendChild(fila);
                }
                

            });
            tabla.appendChild(tablaBody);
            tablaHeader.classList.add('table-dark');
            tabla.classList.add('table','table-striped','border','border-3','table-success');
            document.getElementById('divContactos').appendChild(tabla);
               //mostrar notificacion
               creartNotificacionOK('Contactos obtenidos','todo en orden'); 
            }

            

    function crearTablaContactosError()
    {
        //error not
        creartNotificacionError('No se pueden obtener los datos','Error');
    }

function crearNotificacion(mensaje,titulo)
{
    document.getElementById('mensajeNotificacion').textContent=mensaje;
    document.getElementById('tituloNotificacion').textContent=titulo;
    let elementoNotificacion=document.getElementById('notificacion');
    bootstrap.Toast.getOrCreateInstance(elementoNotificacion).show();
}

function creartNotificacionOK(mensaje,titulo)
{
    crearNotificacion(mensaje,titulo);
    crearIconoOK();
    crearColorNotificacion('--color-verde-oscuro');

}
function creartNotificacionAdvertencia(mensaje,titulo)
{
    crearNotificacion(mensaje,titulo);
    crearIconoAdvertencia();
    crearColorNotificacion('--color-amarillo-oscuro');

}
function creartNotificacionError(mensaje,titulo)
{
    crearNotificacion(mensaje,titulo);
    crearIconoError();
    crearColorNotificacion('--color-rojo-oscuro');
}
function crearIconoOK()
{
    document.getElementById('iconoNotificacion').className='';
    document.getElementById('iconoNotificacion').classList.add('bi','bi-check2-square');
}

function crearIconoError()
{
    document.getElementById('iconoNotificacion').className='';
    document.getElementById('iconoNotificacion').classList.add('bi','bi-bug');
    
}

function crearIconoAdvertencia()
{
    document.getElementById('iconoNotificacion').className='';
    document.getElementById('iconoNotificacion').classList.add('bi','bi-exclamation-square');
}
function crearColorNotificacion(color)
{
    let elementoNotificacion = document.getElementById('notificacion');
    elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue(color);
            
}

        

</script>